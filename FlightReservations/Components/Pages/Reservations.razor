<!--
 /*
 * Reservations.razor
 * This file contains the code for the Reservations page.
 * The Reservations page allows users to search for reservations, view reservation details, and update reservation details.
 * The page contains a search form, a list of reservations, and a form to update reservation details.
 * The page uses the ReservationManager class to interact with the reservation data.
 * The page uses the ReservationValidationException class to validate
 * reservation data before saving it to the file.
 * The page uses the AirportManager class to get a list of airlines for the search form.
 * The page uses the FlightManager class to get a list of flights for the search form.
 * The page uses the Reservation class to represent a reservation.
 */
 -->
@page "/reservations"
@using FlightReservations.Data
<section>
    <h1>Reservations</h1>
    <input type="text" placeholder="Search" @bind="searchTerm" />
    <button @onclick="SearchReservations">Search</button>

    <ul>
        @foreach (var reservation in reservations)
        {
            <li>
                <p>@reservation.TravelerName - @reservation.TravelerCitizen - @reservation.ReservationCode</p>
                <button @onclick="() => SelectReservation(reservation)">Edit</button>
            </li>
        }
    </ul>
</section>

<section>
    <h2>Edit Reservation</h2>
    <input type="text" placeholder="Traveler Name" @bind="selectedReservation.TravelerName" />
    <input type="text" placeholder="Traveler Citizen" @bind="selectedReservation.TravelerCitizen" />
    <button @onclick="UpdateReservation">Save</button>
</section>
@code {
    private string searchTerm = string.Empty;
    private List<Reservation> reservations = new List<Reservation>();
    private Reservation selectedReservation = new Reservation();
    private ReservationManager reservationManager = new ReservationManager();

    private void SearchReservations()
    {
        reservations = reservationManager.FindReservations(searchTerm);
    }

    private void SelectReservation(Reservation reservation)
    {
        selectedReservation = reservation;
    }

    private void UpdateReservation()
    {
        reservationManager.UpdateReservation(selectedReservation);
        SearchReservations();
    }
    protected override void OnInitialized()
    {
        reservations = reservationManager.GetReservations();
    }
} 